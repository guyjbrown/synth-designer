@synth analoguelead
longname : Analogue lead
type : synth
author : Guy J Brown
version : 1.0
doc : Brassy analogue lead sound
@end

# parameters

@param low_cutoff
type : float
mutable: yes
step : 0.01
min : 100
max : 16000
default : 5300
doc : lowpass cutoff frequency
@end

@param resonance
type : float
mutable: yes
step : 0.01
min : 0
max : 25
default : 0
doc : resonance of lowpass filter
@end

@param high_cutoff
type : float
mutable: yes
step : 0.01
min : 20
max : 16000
default : 20
doc : highpass cutoff frequency
@end

@param detune
type : float
mutable: yes
step : 0.01
min : -20
max : 20
default : 3.9
doc : oscillator detune
@end

@param pwm_rate
type : float
mutable: yes
step : 0.01
min : 0.01
max : 5
default : 0.2
doc : PWM rate
@end

@param pwm_depth
type : float
mutable: yes
step : 0.01
min : 0
max : 1
default : 0.7
doc : PWM depth
@end

@param attack
type : float
mutable: yes
step : 0.01
min : 0
max : 5
default : 0.4
doc : attack time
@end

@param decay
type : float
mutable: yes
step : 0.01
min : 0
max : 5
default : 0.1
doc : decay time
@end

@param sustain
type : float
mutable: yes
step : 0.01
min : 0
max : 1
default : 1
doc : sustain level
@end

@param release
type : float
mutable: yes
step : 0.01
min : 0
max : 5
default : 0.4
doc : release time
@end

@param volume
type : float
mutable: yes
step : 0.01
min : 0
max : 1
default : 0.7
doc : overall volume
@end

# modules

SAW-OSC : vco1
PULSE-OSC : vco2
SIN-OSC : lfo
LPF : lowpass
HPF : highpass
VCA : vca
VCA : mix
ADSR : env
VCA : pwm

# patch

vco1.out -> mix.in
vco2.out -> mix.in
mix.out -> highpass.in
highpass.out -> lowpass.in
lowpass.out -> vca.in
vca.out -> audio.in
env.out -> vca.levelCV
lfo.out -> pwm.in
pwm.out -> vco2.pulsewidthCV

# tweak

vco1.pitch = param.pitch
vco2.pitch = param.pitch
vco1.detune = param.detune
vco2.detune = param.detune*-1
mix.level = 0.4
vca.level = param.level
lowpass.cutoff = param.low_cutoff
lowpass.resonance = param.resonance
highpass.cutoff = param.high_cutoff

lfo.pitch=param.pwm_rate
pwm.level = param.pwm_depth*0.49
vco2.pulsewidth=0.5

# envelope

env.attack = param.attack
env.decay = param.decay
env.sustain = param.sustain*param.level*param.volume
env.release = param.release
env.level = param.level*param.volume

# end
